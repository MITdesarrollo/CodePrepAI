import{c,r as n,R as e,M as C}from"./message-circle.WMUx7cqf.js";const M=c("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),S=c("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),A=c("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),j=c("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),R=c("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),i=30;function T(){const[p,h]=n.useState(!1),[a,r]=n.useState([]),[o,f]=n.useState(""),[E,g]=n.useState(!1),[b,x]=n.useState(!1),y=n.useRef(null),v=()=>{y.current?.scrollIntoView({behavior:"smooth"})};n.useEffect(()=>{v()},[a]),n.useEffect(()=>{a.length>=i-5&&x(!0)},[a.length]),n.useEffect(()=>{const t=()=>{u()};return window.addEventListener("openChat",t),()=>{window.removeEventListener("openChat",t)}},[]);const w=async()=>{if(!o.trim())return;if(a.length>=i){const s={role:"assistant",content:'âš ï¸ Has alcanzado el lÃ­mite de 30 mensajes por sesiÃ³n. Por favor, inicia una nueva conversaciÃ³n haciendo clic en "ðŸ”„ Reiniciar". Â¡Gracias! ðŸ˜Š',timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(l=>[...l,s]);return}if(o.length>1e3){alert("Por favor envÃ­a mensajes de mÃ¡ximo 1000 caracteres.");return}const t={role:"user",content:o,timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(s=>[...s,t]),f(""),g(!0);try{const s=a.concat(t).map(d=>({role:d.role,content:d.content})),l=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:s})}),m=await l.json();if(!l.ok)throw new Error(m.message||"Error en la respuesta");const k={role:"assistant",content:m.content,timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(d=>[...d,k])}catch(s){console.error("Error:",s);const l={role:"assistant",content:s.message||"Lo siento, hubo un error. Por favor, intenta de nuevo en unos momentos.",timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(m=>[...m,l])}finally{g(!1)}},u=()=>{if(h(!0),a.length===0){const t={role:"assistant",content:`Â¡Hola! Soy CodePrep AI ðŸš€

Â¿Para quÃ© empresa o posiciÃ³n te estÃ¡s preparando? Contame todo lo que puedas: stack, tipo de rol, lo que sea. Mientras mÃ¡s info, mejor puedo ayudarte.

ðŸ’¡ Tip: TenÃ©s hasta 30 mensajes por sesiÃ³n para practicar tranqui.`,timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r([t])}},N=()=>{r([]),x(!1),u()};return e.createElement(e.Fragment,null,p&&e.createElement("div",{className:"fixed bottom-6 right-6 w-96 h-[600px] bg-slate-900 border border-purple-500/30 rounded-2xl shadow-2xl shadow-purple-500/20 flex flex-col z-50 max-w-[calc(100vw-3rem)]"},e.createElement("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-4 rounded-t-2xl"},e.createElement("div",{className:"flex items-center justify-between mb-2"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center"},e.createElement(S,{className:"w-6 h-6"})),e.createElement("div",null,e.createElement("h3",{className:"font-semibold"},"CodePrep AI"),e.createElement("p",{className:"text-xs text-white/80"},"Powered by Gemini AI and Claude"))),e.createElement("div",{className:"flex items-center gap-2"},e.createElement("button",{onClick:N,className:"hover:bg-white/20 p-2 rounded-lg transition-colors",title:"Reiniciar conversaciÃ³n"},e.createElement(A,{className:"w-4 h-4"})),e.createElement("button",{onClick:()=>h(!1),className:"hover:bg-white/20 p-2 rounded-lg transition-colors"},e.createElement(R,{className:"w-5 h-5"})))),e.createElement("div",{className:"flex items-center justify-between text-xs text-white/70"},e.createElement("span",null,"Mensajes: ",a.length,"/",i),b&&e.createElement("span",{className:"flex items-center gap-1 text-yellow-300"},e.createElement(M,{className:"w-3 h-3"}),"Cerca del lÃ­mite"))),e.createElement("div",{className:"flex-1 overflow-y-auto p-4 space-y-4"},a.map((t,s)=>e.createElement("div",{key:s,className:`flex ${t.role==="user"?"justify-end":"justify-start"}`},e.createElement("div",{className:`max-w-[80%] ${t.role==="user"?"bg-gradient-to-r from-purple-600 to-blue-600 text-white":"bg-slate-800 text-slate-200"} rounded-2xl px-4 py-3`},e.createElement("p",{className:"text-sm whitespace-pre-line"},t.content),e.createElement("p",{className:"text-xs opacity-70 mt-1"},t.timestamp)))),E&&e.createElement("div",{className:"flex justify-start"},e.createElement("div",{className:"bg-slate-800 rounded-2xl px-4 py-3"},e.createElement("div",{className:"flex gap-2"},e.createElement("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.createElement("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.createElement("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})))),e.createElement("div",{ref:y})),e.createElement("div",{className:"p-4 border-t border-purple-500/20"},e.createElement("div",{className:"flex gap-2"},e.createElement("input",{type:"text",value:o,onChange:t=>f(t.target.value),onKeyPress:t=>t.key==="Enter"&&w(),placeholder:"Escribe tu mensaje... (mÃ¡x 1000 caracteres)",maxLength:1e3,disabled:a.length>=i,className:"flex-1 bg-slate-800 border border-purple-500/30 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-purple-500 text-white placeholder-slate-500 disabled:opacity-50"}),e.createElement("button",{onClick:w,disabled:a.length>=i,className:"bg-gradient-to-r from-purple-600 to-blue-600 p-3 rounded-xl hover:shadow-lg hover:shadow-purple-500/50 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},e.createElement(j,{className:"w-5 h-5"}))),e.createElement("p",{className:"text-xs text-slate-500 mt-2 text-center"},o.length,"/1000 caracteres"))),!p&&e.createElement("button",{onClick:u,className:"fixed bottom-6 right-6 w-16 h-16 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full shadow-2xl shadow-purple-500/50 flex items-center justify-center hover:scale-110 transition-transform z-50"},e.createElement(C,{className:"w-8 h-8"})))}export{T as default};
