import{c,j as e,M as k}from"./message-circle.yu7S0YBZ.js";import{r as n}from"./index.CVf8TyFT.js";const M=c("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),S=c("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),A=c("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),E=c("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),L=c("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),l=30;function P(){const[u,p]=n.useState(!1),[t,r]=n.useState([]),[i,x]=n.useState(""),[w,f]=n.useState(!1),[b,g]=n.useState(!1),j=n.useRef(null),v=()=>{j.current?.scrollIntoView({behavior:"smooth"})};n.useEffect(()=>{v()},[t]),n.useEffect(()=>{t.length>=l-5&&g(!0)},[t.length]),n.useEffect(()=>{const s=()=>{h()};return window.addEventListener("openChat",s),()=>{window.removeEventListener("openChat",s)}},[]);const y=async()=>{if(!i.trim())return;if(t.length>=l){const a={role:"assistant",content:'⚠️ Has alcanzado el límite de 30 mensajes por sesión. Por favor, inicia una nueva conversación haciendo clic en "🔄 Reiniciar". ¡Gracias! 😊',timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(o=>[...o,a]);return}if(i.length>1e3){alert("Por favor envía mensajes de máximo 1000 caracteres.");return}const s={role:"user",content:i,timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(a=>[...a,s]),x(""),f(!0);try{const a=t.concat(s).map(m=>({role:m.role,content:m.content})),o=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:a})}),d=await o.json();if(!o.ok)throw new Error(d.message||"Error en la respuesta");const C={role:"assistant",content:d.content,timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(m=>[...m,C])}catch(a){console.error("Error:",a);const o={role:"assistant",content:a.message||"Lo siento, hubo un error. Por favor, intenta de nuevo en unos momentos.",timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r(d=>[...d,o])}finally{f(!1)}},h=()=>{if(p(!0),t.length===0){const s={role:"assistant",content:`¡Hola! Soy CodePrep AI 🚀

¿Para qué empresa o posición te estás preparando? Contame todo lo que puedas: stack, tipo de rol, lo que sea. Mientras más info, mejor puedo ayudarte.

💡 Tip: Tenés hasta 30 mensajes por sesión para practicar tranqui.`,timestamp:new Date().toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})};r([s])}},N=()=>{r([]),g(!1),h()};return e.jsxs(e.Fragment,{children:[u&&e.jsxs("div",{className:"fixed bottom-6 right-6 w-96 h-[600px] bg-slate-900 border border-purple-500/30 rounded-2xl shadow-2xl shadow-purple-500/20 flex flex-col z-50 max-w-[calc(100vw-3rem)]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 p-4 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(S,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"CodePrep AI"}),e.jsx("p",{className:"text-xs text-white/80",children:"Powered by Gemini AI and Claude"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:N,className:"hover:bg-white/20 p-2 rounded-lg transition-colors",title:"Reiniciar conversación",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>p(!1),className:"hover:bg-white/20 p-2 rounded-lg transition-colors",children:e.jsx(L,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-white/70",children:[e.jsxs("span",{children:["Mensajes: ",t.length,"/",l]}),b&&e.jsxs("span",{className:"flex items-center gap-1 text-yellow-300",children:[e.jsx(M,{className:"w-3 h-3"}),"Cerca del límite"]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.map((s,a)=>e.jsx("div",{className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[80%] ${s.role==="user"?"bg-gradient-to-r from-purple-600 to-blue-600 text-white":"bg-slate-800 text-slate-200"} rounded-2xl px-4 py-3`,children:[e.jsx("p",{className:"text-sm whitespace-pre-line",children:s.content}),e.jsx("p",{className:"text-xs opacity-70 mt-1",children:s.timestamp})]})},a)),w&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-slate-800 rounded-2xl px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})}),e.jsx("div",{ref:j})]}),e.jsxs("div",{className:"p-4 border-t border-purple-500/20",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:i,onChange:s=>x(s.target.value),onKeyPress:s=>s.key==="Enter"&&y(),placeholder:"Escribe tu mensaje... (máx 1000 caracteres)",maxLength:1e3,disabled:t.length>=l,className:"flex-1 bg-slate-800 border border-purple-500/30 rounded-xl px-4 py-3 text-sm focus:outline-none focus:border-purple-500 text-white placeholder-slate-500 disabled:opacity-50"}),e.jsx("button",{onClick:y,disabled:t.length>=l,className:"bg-gradient-to-r from-purple-600 to-blue-600 p-3 rounded-xl hover:shadow-lg hover:shadow-purple-500/50 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(E,{className:"w-5 h-5"})})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2 text-center",children:[i.length,"/1000 caracteres"]})]})]}),!u&&e.jsx("button",{onClick:h,className:"fixed bottom-6 right-6 w-16 h-16 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full shadow-2xl shadow-purple-500/50 flex items-center justify-center hover:scale-110 transition-transform z-50",children:e.jsx(k,{className:"w-8 h-8"})})]})}export{P as default};
